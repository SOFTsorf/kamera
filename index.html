<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultimate Camera App</title>
    <style>
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: #000; color: white; overflow: hidden;
            font-family: 'Segoe UI', sans-serif;
        }

        .camera-container {
            position: relative; width: 100%; height: 100%;
            display: flex; justify-content: center; overflow: hidden;
        }

        /* Video mit Zoom-Support */
        #video {
            width: 100%; height: 100%; object-fit: cover;
            transition: transform 0.3s ease;
        }

        /* Der gro√üe Blur-Layer unten (wie im Screenshot) */
        .bottom-panel {
            position: absolute; bottom: 0; width: 100%; height: 280px;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
            display: flex; flex-direction: column; align-items: center;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        /* Obere Leiste (Blur-Pille) */
        .top-ui {
            position: absolute; top: 40px;
            padding: 10px 25px; border-radius: 50px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            display: flex; gap: 20px; font-size: 14px;
        }

        /* Zoom-Pille */
        .zoom-bar {
            margin-top: 20px; padding: 8px 20px;
            background: rgba(255,255,255,0.1); border-radius: 30px;
            display: flex; gap: 20px; font-size: 12px; cursor: pointer;
        }
        .zoom-bar span.active { color: #ffd700; font-weight: bold; }

        /* Steuerung */
        .controls-row {
            margin-top: 40px; width: 100%;
            display: flex; justify-content: space-around; align-items: center;
        }

        .shutter-btn {
            width: 80px; height: 80px; background: white;
            border-radius: 50%; border: 6px solid rgba(255,255,255,0.3);
            cursor: pointer; position: relative;
        }
        .shutter-btn.recording { background: red; border-color: white; border-radius: 15px; }

        .mode-row {
            margin-top: 25px; display: flex; gap: 20px;
            font-size: 11px; font-weight: bold; letter-spacing: 1px;
        }
        .mode-row span { opacity: 0.5; cursor: pointer; }
        .mode-row span.active { color: #ffd700; opacity: 1; }

        svg { fill: white; width: 28px; height: 28px; }
    </style>
</head>
<body>

<div class="camera-container">
    <video id="video" autoplay playsinline></video>
    
    <div class="top-ui">
        <span>12M</span><span>HDR</span>
    </div>

    <div class="bottom-panel">
        <div class="zoom-bar">
            <span onclick="setZoom(1)">.5</span>
            <span id="z1" class="active" onclick="setZoom(1.5)">1x</span>
            <span onclick="setZoom(3)">2</span>
        </div>

        <div class="mode-row">
            <span onclick="setMode('photo')" id="m-photo" class="active">FOTO</span>
            <span onclick="setMode('video')" id="m-video">VIDEO</span>
        </div>

        <div class="controls-row">
            <div style="opacity:0.5"><svg viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg></div>
            
            <div id="shutter" class="shutter-btn"></div>
            
            <div onclick="toggleCamera()" style="cursor:pointer">
                <svg viewBox="0 0 24 24"><path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.41 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.59 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"/></svg>
            </div>
        </div>
    </div>
</div>

<canvas id="canvas" style="display:none;"></canvas>

<script>
    const video = document.getElementById('video');
    const shutter = document.getElementById('shutter');
    let currentStream;
    let useFront = false;
    let mode = 'photo';
    let mediaRecorder;
    let chunks = [];

    async function init(facing = "environment") {
        if (currentStream) currentStream.getTracks().forEach(t => t.stop());
        try {
            currentStream = await navigator.mediaDevices.getUserMedia({
                video: { facingMode: facing, width: 1280, height: 720 }
            });
            video.srcObject = currentStream;
        } catch (e) { alert("Kamera-Fehler. Bitte HTTPS nutzen."); }
    }

    function toggleCamera() {
        useFront = !useFront;
        init(useFront ? "user" : "environment");
    }

    function setZoom(lvl) {
        video.style.transform = `scale(${lvl})`;
        document.querySelectorAll('.zoom-bar span').forEach(s => s.classList.remove('active'));
        event.target.classList.add('active');
    }

    function setMode(m) {
        mode = m;
        document.getElementById('m-photo').classList.toggle('active', m === 'photo');
        document.getElementById('m-video').classList.toggle('active', m === 'video');
    }

    shutter.onclick = () => {
        if (mode === 'photo') {
            const canvas = document.getElementById('canvas');
            canvas.width = video.videoWidth; canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0);
            const a = document.createElement('a');
            a.href = canvas.toDataURL('image/jpeg');
            a.download = `IMG_${Date.now()}.jpg`; a.click();
        } else {
            handleVideo();
        }
    };

    function handleVideo() {
        if (mediaRecorder && mediaRecorder.state === "recording") {
            mediaRecorder.stop();
            shutter.classList.remove('recording');
        } else {
            chunks = [];
            mediaRecorder = new MediaRecorder(currentStream);
            mediaRecorder.ondataavailable = e => chunks.push(e.data);
            mediaRecorder.onstop = () => {
                const blob = new Blob(chunks, { type: 'video/webm' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url; a.download = `VID_${Date.now()}.webm`; a.click();
            };
            mediaRecorder.start();
            shutter.classList.add('recording');
        }
    }

    init();
</script>
</body>
</html>
