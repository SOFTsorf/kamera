<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pro Camera App</title>
    <style>
        :root {
            --blur-bg: rgba(30, 30, 30, 0.5);
            --accent: #FFD700;
        }

        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            background: #000; color: white;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            overflow: hidden;
        }

        .camera-view {
            position: relative;
            width: 100%; height: 100%;
            display: flex; justify-content: center; overflow: hidden;
        }

        #video {
            width: 100%; height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        /* Top Bar */
        .top-bar {
            position: absolute; top: 30px;
            display: flex; align-items: center; justify-content: space-between;
            width: 80%; padding: 12px 24px;
            background: var(--blur-bg);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-radius: 40px; border: 1px solid rgba(255,255,255,0.1);
            z-index: 10;
        }

        /* Unterer großer Blur-Layer */
        .bottom-ui {
            position: absolute; bottom: 0;
            width: 100%; height: 280px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(40px); -webkit-backdrop-filter: blur(40px);
            display: flex; flex-direction: column; align-items: center;
            border-top: 1px solid rgba(255,255,255,0.1);
            z-index: 10;
        }

        .zoom-capsule {
            margin-top: 20px;
            display: flex; gap: 20px;
            background: rgba(255,255,255,0.15);
            padding: 8px 20px; border-radius: 30px;
            font-size: 13px; font-weight: 600;
        }
        .zoom-capsule span { cursor: pointer; opacity: 0.6; }
        .zoom-capsule span.active { opacity: 1; color: var(--accent); }

        .modes {
            margin-top: 25px;
            display: flex; gap: 20px;
            font-size: 12px; font-weight: bold; letter-spacing: 1px;
        }
        .modes span { cursor: pointer; opacity: 0.5; transition: 0.3s; }
        .modes span.active { opacity: 1; color: var(--accent); }

        .actions {
            margin-top: 30px;
            width: 85%;
            display: flex; align-items: center; justify-content: space-around;
        }

        .shutter {
            width: 75px; height: 75px;
            background: white; border-radius: 50%;
            border: 5px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
        }
        .shutter.recording { background: #ff4444; border-radius: 12px; animation: pulse 1.5s infinite; }

        .btn-circle {
            width: 48px; height: 48px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
        }

        svg { fill: white; width: 24px; height: 24px; }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

<div class="camera-view">
    <video id="video" autoplay playsinline muted></video>

    <div class="top-bar">
        <svg viewBox="0 0 24 24"><path d="M7 2v11h3v9l7-12h-4l4-8z"/></svg>
        <span style="font-size: 12px;">12M • HDR</span>
        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>
    </div>

    <div class="bottom-ui">
        <div class="zoom-capsule">
            <span onclick="setZoom(1.0, this)">.5</span>
            <span class="active" onclick="setZoom(1.5, this)">1x</span>
            <span onclick="setZoom(3.0, this)">2</span>
        </div>

        <div class="modes">
            <span id="m-photo" class="active" onclick="changeMode('photo')">FOTO</span>
            <span id="m-video" onclick="changeMode('video')">VIDEO</span>
        </div>

        <div class="actions">
            <div class="btn-circle">
                <svg viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
            </div>

            <div id="shutterBtn" class="shutter"></div>

            <div class="btn-circle" onclick="flipCam()">
                <svg viewBox="0 0 24 24"><path d="M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.41 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.59 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z"/></svg>
            </div>
        </div>
    </div>
</div>

<canvas id="output" style="display:none;"></canvas>

<script>
    const v = document.getElementById('video');
    const sBtn = document.getElementById('shutterBtn');
    let stream;
    let front = false;
    let mode = 'photo';
    let rec;
    let chunks = [];

    async function start() {
        if (stream) stream.getTracks().forEach(t => t.stop());
        
        const constraints = {
            video: { 
                facingMode: front ? "user" : "environment",
                width: { ideal: 1280 } 
            },
            audio: true
        };

        try {
            stream = await navigator.mediaDevices.getUserMedia(constraints);
            v.srcObject = stream;
            v.play();
        } catch (e) {
            alert("Kamera-Fehler: " + e.name + "\nBitte stelle sicher, dass keine andere App die Kamera nutzt.");
        }
    }

    function flipCam() {
        front = !front;
        start();
    }

    function setZoom(val, el) {
        v.style.transform = `scale(${val})`;
        document.querySelectorAll('.zoom-capsule span').forEach(s => s.classList.remove('active'));
        el.classList.add('active');
    }

    function changeMode(m) {
        mode = m;
        document.getElementById('m-photo').className = m === 'photo' ? 'active' : '';
        document.getElementById('m-video').className = m === 'video' ? 'active' : '';
    }

    sBtn.onclick = () => {
        if (mode === 'photo') {
            const c = document.getElementById('output');
            c.width = v.videoWidth; c.height = v.videoHeight;
            c.getContext('2d').drawImage(v, 0, 0);
            const a = document.createElement('a');
            a.href = c.toDataURL('image/jpeg');
            a.download = `IMG_${Date.now()}.jpg`; a.click();
            v.style.opacity = "0.5"; setTimeout(() => v.style.opacity = "1", 100);
        } else {
            if (rec && rec.state === "recording") {
                rec.stop();
                sBtn.classList.remove('recording');
            } else {
                chunks = [];
                rec = new MediaRecorder(stream);
                rec.ondataavailable = e => chunks.push(e.data);
                rec.onstop = () => {
                    const blob = new Blob(chunks, { type: 'video/webm' });
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(blob);
                    a.download = `VID_${Date.now()}.webm`; a.click();
                };
                rec.start();
                sBtn.classList.add('recording');
            }
        }
    };

    start();
</script>
</body>
</html>
